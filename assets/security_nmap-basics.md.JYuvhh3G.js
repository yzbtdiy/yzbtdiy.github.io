import{_ as s,c as i,o as a,a5 as n}from"./chunks/framework.ByOCcFwP.js";const E=JSON.parse('{"title":"Nmap 参数","description":"","frontmatter":{"title":"Nmap 参数","date":"2020-12-26T13:01:48.000Z","categories":"security","tags":["scan"]},"headers":[],"relativePath":"security/nmap-basics.md","filePath":"security/nmap-basics.md"}'),h={name:"security/nmap-basics.md"},k=n(`<h3 id="端口状态" tabindex="-1">端口状态 <a class="header-anchor" href="#端口状态" aria-label="Permalink to &quot;端口状态&quot;">​</a></h3><p>端口状态</p><ul><li>Open 开放状态</li><li>Closed 关闭状态</li><li>Filterd 被过滤无法接收到返回的 probe 状态</li><li>UnFilterd 收到返回的 probe, 但是无法确认</li><li>Open/UnFilterd 开放或未过滤状态</li><li>Closed/UnFilterd 关闭或未过滤状态</li></ul><p>Nmap 会先判断输入的参数中是否包含域名, 若包含域名则利用 DNS 服务器进行域名解析, 然后发送 <code>ICMP Echo Request</code> 来探测主机存活性, 根据返回的数据包信息获取信息.</p><p>Nmpa 在探测域名之前需要通过 DNS 进行域名解析, 可以通过 <code>--dns-servers</code> 指定特定的 DNS 服务器.</p><p>已知主机存活或防火墙开启的机器, 可以使用 <code>-Pn</code> 停止探测之前的 ICMP 请求, 避免触发防火墙的安全机制.</p><h3 id="服务指纹" tabindex="-1">服务指纹 <a class="header-anchor" href="#服务指纹" aria-label="Permalink to &quot;服务指纹&quot;">​</a></h3><p>知道目标系统中服务的指纹信息有助于更好的进行渗透测试, 服务指纹信息包括服务端口, 服务名和版本等信息.</p><p>Nmap 通过向目标主机发送多个 UDP 与 TCP 数据包并分析其响应来进行操作系统指纹识别, 根据数据包中的协议标记, 选项和数据, 可以推断发送数据包的操作系统.</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -sV 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00013s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 997</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     OpenSSH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (protocol </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Apache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((centos))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3306/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.5.5-10.5.8-MariaDB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0C:29:8E:42:8F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (VMware)</span></span></code></pre></div><p><strong>侵略性探测</strong></p><ul><li><code>-A</code> 获取目标服务器更详细的信息</li><li><code>-v</code> 显示扫描过程</li><li><code>-T4</code> <code>T0</code>-<code>T5</code> 6 个级别, 前两个级别用于 IDS 躲避, <code>T4</code> 属于性能时间折中的选择, <a href="https://wizardforcel.gitbooks.io/nmap-man-page/content/11.html" target="_blank" rel="noreferrer">详细说明</a></li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -A -v -T4 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00079s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 997</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     OpenSSH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (protocol </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh-hostkey:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   3072</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> de:2c:af:fd:04:77:8f:67:69:38:eb:b8:6a:1d:d8:13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (RSA)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 34:4d:9d:86:24:04:dc:1d:4c:86:8b:a4:66:eb:7b:d1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ECDSA)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2a:ac:d7:fb:2d:7c:4f:8c:1f:d5:f3:23:3d:47:11:9b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ED25519)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Apache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((centos))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-methods:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Potentially</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> risky</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> methods:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TRACE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_http-server-header:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apache/2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (centos)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_http-title:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Machine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3306/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.5.5-10.5.8-MariaDB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mysql-info:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Protocol:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.5.5-10.5.8-MariaDB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Thread</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12187</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Capabilities</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flags:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 63486</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Some</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Capabilities:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Support41Auth,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Speaks41ProtocolOld,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DontAllowDatabaseTableColumn,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ConnectWithDatabase,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsTransactions,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ODBCClient,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FoundRows,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IgnoreSigpipes,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IgnoreSpaceBeforeParenthesis,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> InteractiveClient,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Speaks41ProtocolNew,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsLoadDataLocal,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsCompression,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LongColumnFlag,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsMultipleStatments,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsMultipleResults,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsAuthPlugins</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Status:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Autocommit</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Salt:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RV7PmUA&#39;:1%dJ%uC-XSu</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">|_  Auth Plugin Name: mysql_native_password</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MAC Address: 00:0C:29:8E:42:8F (VMware)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Device type: general purpose</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Running: Linux 3.X|4.X</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">OS details: Linux 3.2 - 4.9</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Network Distance: 1 hop</span></span></code></pre></div><ul><li><code>-sC</code> <code>--script=default</code> 使用 Nmap 脚本进行探测</li><li><code>-sV</code> 探测目标机器上的服务信息</li><li><code>-O</code> 探测目标机器的操作系统信息</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -sC -sV -O 192.168.3.8</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00068s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 997</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     OpenSSH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (protocol </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ssh-hostkey:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   3072</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> de:2c:af:fd:04:77:8f:67:69:38:eb:b8:6a:1d:d8:13</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (RSA)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 34:4d:9d:86:24:04:dc:1d:4c:86:8b:a4:66:eb:7b:d1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ECDSA)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  256</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2a:ac:d7:fb:2d:7c:4f:8c:1f:d5:f3:23:3d:47:11:9b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (ED25519)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Apache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((centos))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-methods:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Potentially</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> risky</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> methods:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TRACE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_http-server-header:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apache/2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (centos)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_http-title:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Machine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3306/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.5.5-10.5.8-MariaDB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mysql-info:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Protocol:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Version:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.5.5-10.5.8-MariaDB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Thread</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Capabilities</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flags:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 63486</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Some</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Capabilities:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FoundRows,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ConnectWithDatabase,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IgnoreSigpipes,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsTransactions,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IgnoreSpaceBeforeParenthesis,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Speaks41ProtocolOld,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Support41Auth,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ODBCClient,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsCompression,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> InteractiveClient,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DontAllowDatabaseTableColumn,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsLoadDataLocal,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Speaks41ProtocolNew,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LongColumnFlag,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsMultipleStatments,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsMultipleResults,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SupportsAuthPlugins</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Status:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Autocommit</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Salt:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jc5{1{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UvtdyRoVC+M$i</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Auth</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Plugin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql_native_password</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0C:29:8E:42:8F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (VMware)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Device</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> general</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> purpose</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Running:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3.X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">4.X</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CPE:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpe:/o:linux:linux_kernel:3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpe:/o:linux:linux_kernel:4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">OS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> details:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.9</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Distance:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hop</span></span></code></pre></div><h3 id="主机发现" tabindex="-1">主机发现 <a class="header-anchor" href="#主机发现" aria-label="Permalink to &quot;主机发现&quot;">​</a></h3><ul><li><code>-sn</code> 使用 ping 探测主机存活性, 扫描过程用到了 <code>TCP SYN</code> 扫描, <code>ICMP echo Request</code> 等来探测主机存活, 禁用了端口扫描, <code>-sP</code> 结果相同</li><li><code>-oX</code> 将扫描结果保存为 xml 文件, <code>-oN</code> 保存为文本, <code>-oS</code> 保存为 script, <code>-oG</code> 保存为 kiddi3</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -sn 192.168.3.0/24 -oX scan.xml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.0066s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> A8:0C:63:5F:CD:F9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Huawei </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Technologies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.24</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.036s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 74:38:B7:34:5C:2F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Canon)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00050s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0C:29:8E:42:8F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (VMware)</span></span></code></pre></div><h3 id="端口探测" tabindex="-1">端口探测 <a class="header-anchor" href="#端口探测" aria-label="Permalink to &quot;端口探测&quot;">​</a></h3><ul><li><code>-p</code> 指定端口进行测试 <ul><li>使用 <code>,</code> 分割多个端口, <code>m-n</code> 指定端口范围, <code>-</code> 检测所有端口</li><li><code>T:80,U:53</code> 可以通过 <code>T</code> 和 <code>U</code> 关键字指定协议, udp 协议需要时使用 <code>-sU</code></li><li>可以直接通过协议名查看端口, 如 <code>http</code>, <code>dns</code> 等, 协议名可以使用 <code>*</code> 模糊匹配</li></ul></li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -p- 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.0011s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 65532</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3306/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0C:29:8E:42:8F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (VMware)</span></span></code></pre></div><h3 id="nse-nmap-script-engine" tabindex="-1">NSE (Nmap Script Engine) <a class="header-anchor" href="#nse-nmap-script-engine" aria-label="Permalink to &quot;NSE (Nmap Script Engine)&quot;">​</a></h3><ul><li>Nmap 内置许多针对特定任务的扫描脚本, 使用 <code>--script</code> 指定需要执行的脚本</li><li>Linux 版本 Nmap 内置脚本位于 <code>/usr/share/nmap/scripts/</code> 目录中</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap --script http-title,http-headers 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.000059s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 997</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-headers:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Date:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mon,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 08:08:27</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GMT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Server:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Apache/2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (centos)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Last-Modified:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mon,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 04</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 06:23:16</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> GMT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   ETag:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;1f5-5b80d201a5b45&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Accept-Ranges:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Content-Length:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 501</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Connection:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> close</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Content-Type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> text/html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; charset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">UTF-8</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (Request </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">type:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEAD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_http-title:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Target</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Machine</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3306/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Address:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:0C:29:8E:42:8F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (VMware)</span></span></code></pre></div><ul><li>Nmap 使用 vuln 分类脚本可以更快找到目标的信息与弱点</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@kali </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# nmap -sV --script vuln 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Pre-scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> results:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> broadcast-avahi-dos:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Discovered</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hosts:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     224.0.0.251</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   After</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> NULL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UDP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> avahi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DoS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (CVE-2011-1002).</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  Hosts</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (not </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vulnerable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> report</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0.00097s </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shown:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 997</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> closed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PORT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     STATE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SERVICE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERSION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">22/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     OpenSSH</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (protocol </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> vulners:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   cpe:/a:openbsd:openssh:8.0:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       CVE-2020-15778</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  6.8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     https://vulners.com/cve/CVE-2020-15778</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">       CVE-2019-16905</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  4.4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     https://vulners.com/cve/CVE-2019-16905</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      CVE-2020-14145</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  4.3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     https://vulners.com/cve/CVE-2020-14145</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">80/tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  http</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Apache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.4.37</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((centos))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> http-csrf:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Spidering</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> limited</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> maxdepth=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; maxpagecount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; withinhost</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">192.168.3.38</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> following</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> possible</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> CSRF</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vulnerabilities:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://192.168.3.38:80/mutillidae/</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Form</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Form</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://www.paypal.com/cgi-bin/webscr</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Path:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://192.168.3.38:80/mutillidae/index.php?page=secret-administrati</span></span></code></pre></div>`,26),p=[k];function l(t,F,e,d,r,g){return a(),i("div",null,p)}const C=s(h,[["render",l]]);export{E as __pageData,C as default};
